---
title: "aquaculture_mapping"
author: "Robert Saldivar"
date: "4/17/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
#Loading Packages

library(tidyverse)
library(here)
library(janitor)
library(tmap)
library(tmaptools)
library(ggmap)
library(sf)
library(sp)
library(leaflet)
library(rgdal)
library(rgeos)
```

```{r, message = FALSE}
#Reading in data

data_goals <- read_csv("data_goals.csv")
data_end_users <- read_csv("data_end_users.csv")
scores_clean <- read_csv("scores_clean.csv")

#reading in county shape files for CA, OR, and WA these will be used for basemaps
ca_counties <- read_sf(dsn = here("locations"), layer = "CA_counties")
or_counties <- read_sf(dsn = here("locations"), layer = "OR_counties")
wa_counties <- read_sf(dsn = here("locations"), layer = "WA_counties")

```

```{r, message=FALSE}
#Cleaning and wrangling the data

data_scores <- full_join(data_goals, scores_clean)


estuary_sf <- data_scores %>%
  drop_na("Long") %>%
  st_as_sf(coords = c("Long", "Lat"), crs = 4326) %>%
  clean_names()

```

```{r}
#Making an interactive map with tmap

snapp_estuary_map <- tm_shape(estuary_sf) +
  tm_dots(labels = "estuary_or_subbasin", col = "green", size = 0.1)

basemap <- tm_basemap("Esri.WorldImagery")

tmap_mode("view")
snapp_estuary_map +
  basemap


```

```{r}
#This is going to be a static map of estuary locations

ggplot() +
  geom_sf(data = ca_counties) +
  geom_sf(data = or_counties) +
  geom_sf(data = wa_counties) +
  geom_sf(data = estuary_sf, crs = 4326, size = 4, aes(color = ecological)) +
  coord_sf(xlim = c(-125, -115), ylim = c(30, 50)) +
  scale_color_gradientn(colors = c(
    "red",
    "green",
    "blue"
  )
  ) +
  theme_minimal()

# I think it might look better if instead of counties they were just an outline of the state.

```



```{r}
# Making maps with Shapefiles

pacific_estuary <- read_sf(dsn = here("locations"), layer = "Pacific_estuary_shore_dist") %>%
  st_transform(crs = 4326)
  

# st_crs(pacific_estuary) checking the coordingate reference system of pacific_esturary

plot(pacific_estuary)

pacific_estuary_plot <- ggplot() +
  geom_sf(data = ca_counties) +
  geom_sf(data = wa_counties) +
  geom_sf(data = or_counties) +
  geom_sf(data = pacific_estuary, aes(fill = shore_dist)) +
  scale_fill_gradientn(colors = c(
    "green",
    "yellow",
    "red"
  )) +
  theme_minimal() 

pacific_estuary_plot

#this map would look betrer if counties were dissolved.


```


```{r}
#This is going to be an experiment to see if I can get
```

